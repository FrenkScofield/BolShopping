@using BolShpping.Models.VM
@model ViewModel
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="main-wrapper single-product-page">


    <!-- breadcrumb-area start -->
    <div class="breadcrumb-area breadcramb-bg ptb-80">
        <div class="container">
            <div class="row">
                <div class="col">
                    <h2 class="breadcrumb-title">Shop</h2>
                    <ul class="breadcrumb-list">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item active">Single product</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- breadcrumb-area end -->
    <!-- main-content-warpper start -->
    <div class="main-content-warpper pt-80">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="product-thumbnail">
                        <div class="tab-content large-thum-image">
                            <div id="img-1" class="zoomWrapper single-zoom">
                                <a href="#">
                                    <img id="zoom1" src="~/img/@_context.ProductImages?.Where(pi => pi.ProductId == Model.Product.Id).FirstOrDefault().ImageCode" data-zoom-image="~/img/@_context.ProductImages?.Where(pi => pi.ProductId == Model.Product.Id).FirstOrDefault().ImageCode" alt="big-1">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="modal-product-tab">
                        <ul class="nav product-small-thum slider-vertical s-tab-zoom " id="gallery_01">
                            @{ int i = 1;}
                            @foreach (var item in _context.ProductImages)
                            {
                                if (Model.Product.Id == item.ProductId)
                                {
                                    <li>
                                        <a href="#" class="elevatezoom-gallery @(i == 1 ? "active" : "") " data-update="" data-image="~/img/@item.ImageCode" data-zoom-image="~/img/@item.ImageCode"><img src="~/img/@item.ImageCode" alt="zo-th-1" /></a>
                                    </li>

                                    i++;
                                }
                            }
                        </ul>
                    </div>

                </div>
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="quick-view-content">
                        <div class="product-info">
                            <h2>@Model.Product.Name</h2>
                            <div class="price-box">
                                <span class="new-price">$@Model.Product.Price</span>
                                <span class="old-price">$@Model.Product.DiscountPrice</span>
                            </div>
                            <p>
                                @Model.Product.Description
                            </p>
                            <form class="modal-cart">
                                <div class="quantity">
                                    <label>Quantity</label>
                                    <div class="cart-plus-minus">
                                        <input class="cart-plus-minus-box" type="text" value="0">
                                    </div>
                                </div>
                            </form>
                            <div class="quick-add-to-cart">
                                <button class="quick-add-to-btn addCart" id="@Model.Product.Id">Add to cart</button>
                            </div>
                        </div>
                        <div class="social-sharing">
                            <h4>Share</h4>
                            <ul class="size-product">
                                <b>Size:</b>
                                <li>@Model.Product.Size</li>

                            </ul>
                            <ul class="color-product">
                                <b>Color:</b>
                                <li>@Model.Product.Color</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="product-info-detailed ptb-80">
                        <div class="discription-tab-menu">
                            <ul role="tablist" class="nav">
                                <li class="active"><a href="#description" data-toggle="tab" class="active show">Description</a></li>
                                @*<li><a href="#review" data-toggle="tab">Reviews (1)</a></li>*@
                            </ul>
                        </div>

                        <div class="discription-content">
                            <div class="tab-content">
                                <div class="tab-pane fade in active show" id="description">
                                    <div class="description-content">
                                        <p>
                                           @Model.Product.Description
                                        </p>
                                    </div>
                                </div>
                                @*<div id="review" class="tab-pane fade">
                                    <form class="form-review">
                                        <div class="review">
                                            <table class="table table-striped table-bordered table-responsive">
                                                <tbody>
                                                    <tr>
                                                        <td class="table-name"><strong>Raloza</strong></td>
                                                        <td class="text-right">12/08/2018</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <p>
                                                                It’s both good and bad. If Nikon had achieved a high-quality wide lens camera with a 1 inch sensor, that would have been a very competitive product. So in that sense, it’s good for us. But
                                                                actually, from the perspective of driving the 1 inch sensor market, we want to stimulate this market and that means multiple manufacturers.
                                                            </p>
                                                            <ul>
                                                                <li><i class="fa fa-star-o"></i></li>
                                                                <li><i class="fa fa-star-o"></i></li>
                                                                <li><i class="fa fa-star-o"></i></li>
                                                                <li><i class="fa fa-star-o"></i></li>
                                                                <li><i class="fa fa-star-o"></i></li>
                                                            </ul>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="review-wrap">
                                            <h2>Write a review</h2>
                                            <div class="form-group row">
                                                <div class="col">
                                                    <label class="control-label">Your Name</label>
                                                    <input type="text" class="form-control">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col">
                                                    <label class="control-label">Your Review</label>
                                                    <textarea class="form-control"></textarea>
                                                    <div class="help-block"><span class="text-danger">Note:</span> HTML is not translated!</div>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col">
                                                    <label class="control-label">Rating</label> &nbsp;&nbsp;&nbsp; Bad&nbsp;
                                                    <input type="radio" value="1" name="rating"> &nbsp;
                                                    <input type="radio" value="2" name="rating"> &nbsp;
                                                    <input type="radio" value="3" name="rating"> &nbsp;
                                                    <input type="radio" value="4" name="rating"> &nbsp;
                                                    <input type="radio" value="5" name="rating"> &nbsp;Good
                                                </div>
                                            </div>
                                        </div>
                                        <div class="buttons clearfix">
                                            <div class="pul-right">
                                                <button class="button-review" type="button">Continue</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>*@
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="related-products">
                        <div class="row">
                            <div class="col">
                                <!-- section-title start -->
                                <div class="section-title text-center">
                                    <h2>Related Products</h2>
                                </div>
                                <!-- section-title end -->
                            </div>
                        </div>
                        <div class="row">

                            @foreach (var item in Model.Products)
                            {
                                @if (item.Id != Model.Product.Id)
                                {
                                    <div class="col-lg-4">



                                        @*single-product-wrap start*@
                                        <div class="single-product-wrap">
                                            <div class="product-thumbnail">
                                                <a href="single-product.html"><img src="~/img/@_context.ProductImages?.Where(pi => pi.ProductId == Model.Product.Id).FirstOrDefault().ImageCode" alt=""></a>
                                                <span class="label-sale">new</span>
                                                <span class="label-sale discount">-12%</span>
                                                <div class="product-action">
                                                    <a href="#" class="add-to-cart-btn"><i class="icon ion-bag"></i></a>
                                                    <a href="#" class="quick-view" data-toggle="modal" data-target="#exampleModalCenter"><i class="ion-search"></i></a>
                                                    <a href="single-product.html" class="links-details"><i class="ion-clipboard"></i></a>
                                                </div>
                                            </div>
                                            <div class="product-content text-center">
                                                <h3 class="product-name"><a href="single-product.html">@item.Name</a></h3>
                                                <div class="price-box">
                                                    <span class="old-price">$@item.DiscountPrice</span>
                                                    <span class="new-price">$@item.Price</span>
                                                </div>
                                            </div>

                                            @*single-product-wrap end*@
                                        </div>

                                    </div>
                                }
                            }


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- main-content-warpper end -->


    @section Scripts{
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>



        <script>
            $(document).on("click", ".addCart", function (e) {
                let id = $(this)[0].id;
                console.log(id)
                let quantity = $(".cart-plus-minus-box").val();
                console.log(quantity)


                $.ajax({
                    url: "/ProductDetail/AddBasket/",
                    method: "POST",
                    data: { id: id, quantity: quantity },
                    dataType: "json",
                    success: function myfunction(response) {
                        console.log(response.status)

                        if (response.status === 200) {
                            swal({
                                title: "Basket",
                                text: "Məhsulunuz səbətiniz-ə əlavə olundu",
                                icon: "success",
                            });
                            setTimeout(function () { location.reload(); }, 1700);

                        }
                        else if (response.status === 404) {
                            swal({
                                title: "Basket",
                                text: "Bu Məhsul artıq səbətinizdə var",
                                icon: "warning",
                            });
                        }
                        else if (response.status === 400) {
                            swal({
                                title: "Basket",
                                text: "Zəhmət olmasa qeydiyyatdan kecin",
                                icon: "warning",
                            });
                        }

                    }

                })
            })
        </script>
        @*.data("productId")*@
    }


</div>
